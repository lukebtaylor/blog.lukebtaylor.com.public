<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>active directory on Luke's blog site</title><link>http://blog.lukebtaylor.com/tags/active-directory/</link><description>Recent content in active directory on Luke's blog site</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Thu, 21 Jul 2016 22:11:44 -0600</lastBuildDate><atom:link href="http://blog.lukebtaylor.com/tags/active-directory/index.xml" rel="self" type="application/rss+xml"/><item><title>C# - Get All Active Directory Users in a Group</title><link>http://blog.lukebtaylor.com/posts/c#-get-all-active-directory-users-in-group/</link><pubDate>Thu, 21 Jul 2016 22:11:44 -0600</pubDate><guid>http://blog.lukebtaylor.com/posts/c#-get-all-active-directory-users-in-group/</guid><description>Use the following handy method to get all users in an AD group .NET 3.5
Add a reference to
System.DirectoryServices.AccountManagement public static List&amp;lt;UserPrincipal&amp;gt; GetAllUsersInGroup(string domain, string groupname) { List&amp;lt;UserPrincipal&amp;gt; result = new List&amp;lt;UserPrincipal&amp;gt;(); using (var context = new PrincipalContext(ContextType.Domain, domain)) using (var group = GroupPrincipal.FindByIdentity(context, groupname)) { if (group != null) { result.AddRange(group.GetMembers(true).Cast&amp;lt;UserPrincipal&amp;gt;().ToList()); } } return result; } private static string GetADStatus(int inputField) { // Assume the user is disabled string result = &amp;#34;Disabled&amp;#34;; // Declare the hex for the accountDisabled flag int accountDisabled = 0x00000002; // https://msdn.</description></item></channel></rss>