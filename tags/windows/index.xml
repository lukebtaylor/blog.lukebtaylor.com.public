<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>windows on Luke's blog site</title><link>https://blog.lukebtaylor.com/tags/windows/</link><description>Recent content in windows on Luke's blog site</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Fri, 16 Feb 2018 22:17:05 -0600</lastBuildDate><atom:link href="https://blog.lukebtaylor.com/tags/windows/index.xml" rel="self" type="application/rss+xml"/><item><title>VM - Windows domain machine trust relationship fails</title><link>https://blog.lukebtaylor.com/posts/vm-windows-domain-machine-trust-relationship-fails/</link><pubDate>Fri, 16 Feb 2018 22:17:05 -0600</pubDate><guid>https://blog.lukebtaylor.com/posts/vm-windows-domain-machine-trust-relationship-fails/</guid><description>A little background So you&amp;rsquo;ve got some VM&amp;rsquo;s lying around for testing and whatnot. You may rollback to various checkpoints or snapshots in order to test different scenarios.
Then occasionally, you find that you can&amp;rsquo;t log onto the domain anymore because the trust relationship has been lost.
At this point, you either:
Log on with a local admin account Unjoin the domain and rejoin Disconnect your VM&amp;rsquo;s networking Log in using some cached AD credentials Reconnect networking Unjoin the domain and rejoin Either way, very annoying.</description></item><item><title>Yubikey - Silently Enroll PIV Using Certreq</title><link>https://blog.lukebtaylor.com/posts/yubikey-silently-enroll-piv-using-certreq/</link><pubDate>Thu, 08 Feb 2018 18:46:14 -0600</pubDate><guid>https://blog.lukebtaylor.com/posts/yubikey-silently-enroll-piv-using-certreq/</guid><description>Yubikey - Silently enroll PIV using certreq This will allow a Yubikey to be silently enrolled for a CA cert from AD without user intervention. Of course, we would want to prompt a user for their PIN first, then use that for the enrollment.
Additionally, the default PUK and Management key should be changed.
REM This method required the Yubico MiniDriver to be installed on the enrollment station REM To do this silently, ensure that the Certificate Template is set to &amp;#34;Enroll subject without requiring any user input&amp;#34; on the &amp;#34;Request Handling&amp;#34; tab of the Certificate Template&amp;#39;s Properties.</description></item><item><title>Windows - Find file from command line</title><link>https://blog.lukebtaylor.com/posts/windows-find-file-from-command-line/</link><pubDate>Fri, 02 Feb 2018 22:18:57 -0600</pubDate><guid>https://blog.lukebtaylor.com/posts/windows-find-file-from-command-line/</guid><description>Command Prompt dir &amp;lt;filename&amp;gt; /s /p /S include all subfolders. /P Pause after each screen of data. https://ss64.com/nt/dir.html
PowerShell Get-ChildItem -Path V:\Myfolder -Filter CopyForbuild.bat -Recurse -ErrorAction SilentlyContinue -Force https://blogs.technet.microsoft.com/heyscriptingguy/2016/06/27/use-windows-powershell-to-search-for-files/</description></item><item><title>Windows - MMC Command Line Shortcuts</title><link>https://blog.lukebtaylor.com/posts/windows-mmc-command-line-shortcuts/</link><pubDate>Tue, 30 Jan 2018 22:11:44 -0600</pubDate><guid>https://blog.lukebtaylor.com/posts/windows-mmc-command-line-shortcuts/</guid><description>Admin Applet Command AD Domains and Trusts domain.msc Active Directory Management admgmt.msc AD Sites and Services dssite.msc AD Users and Computers dsa.msc ADSI Edit adsiedit.msc Authorization manager azman.msc Certification Authority Management certsrv.msc Certificate Templates certtmpl.msc Cluster Administrator cluadmin.exe Computer Management compmgmt.msc Component Services comexp.</description></item><item><title>Windows - Get File Checksum</title><link>https://blog.lukebtaylor.com/posts/windows-get-file-checksum/</link><pubDate>Wed, 24 Jan 2018 15:29:48 -0600</pubDate><guid>https://blog.lukebtaylor.com/posts/windows-get-file-checksum/</guid><description>Get Checksum (Hash) of File on Windows Use a built-in way to get file checksums from the command line in Windows.
Use the following syntax to get the SHA1 checksum of a file.
certutil -hashfile &amp;lt;filename&amp;gt; SHA1 Help Running the following command
certutil -hashfile -? Will show all the options and usage for the -hashfile verb. Luckily, certutil supports the deprecated MD5 hash, which is not good for security but still has value in certain areas of IT.</description></item><item><title>Windows - Deleting Protected Folders</title><link>https://blog.lukebtaylor.com/posts/windows-deleting-protected-folders/</link><pubDate>Fri, 12 Aug 2016 22:18:57 -0600</pubDate><guid>https://blog.lukebtaylor.com/posts/windows-deleting-protected-folders/</guid><description>Let&amp;rsquo;s say you have some user folders or some other such folder (or file) in Windows that you need to delete, but you get an unauthorized access error.
There are a couple of things you need to do before you can remove a protected folder/file. This process assumes you are part of the Administrators group. Also, run the command prompt as admin when running these commands.
Take ownership Grant permissions Remove the folder Take Ownership</description></item><item><title>dotnet - Get All Active Directory Users in a Group</title><link>https://blog.lukebtaylor.com/posts/dotnet-get-all-active-directory-users-in-group/</link><pubDate>Thu, 21 Jul 2016 22:11:44 -0600</pubDate><guid>https://blog.lukebtaylor.com/posts/dotnet-get-all-active-directory-users-in-group/</guid><description>Use the following handy method to get all users in an AD group .NET 3.5
Add a reference to
System.DirectoryServices.AccountManagement public static List&amp;lt;UserPrincipal&amp;gt; GetAllUsersInGroup(string domain, string groupname) { List&amp;lt;UserPrincipal&amp;gt; result = new List&amp;lt;UserPrincipal&amp;gt;(); using (var context = new PrincipalContext(ContextType.Domain, domain)) using (var group = GroupPrincipal.FindByIdentity(context, groupname)) { if (group != null) { result.AddRange(group.GetMembers(true).Cast&amp;lt;UserPrincipal&amp;gt;().ToList()); } } return result; } private static string GetADStatus(int inputField) { // Assume the user is disabled string result = &amp;#34;Disabled&amp;#34;; // Declare the hex for the accountDisabled flag int accountDisabled = 0x00000002; // https://msdn.</description></item><item><title>Windows - Robocopy File Mirrors and Backups</title><link>https://blog.lukebtaylor.com/posts/windows-robocopy-file-mirrors-and-backups/</link><pubDate>Tue, 12 Jul 2016 22:18:35 -0600</pubDate><guid>https://blog.lukebtaylor.com/posts/windows-robocopy-file-mirrors-and-backups/</guid><description>Using the /MIR switch Copy all files, replacing files in the destination or deleting files in the destination that are not in the source folder.
Copy without any permissions. robocopy &amp;#34;\\MySource\Folder&amp;#34; &amp;#34;\\MyDestination\Folder&amp;#34; /MIR /r:1 /w:1 /copy:DAT /xf *.pst Thumbs.db /np /tee /log:c:\roboCopy.log /MIR Mirrors a directory tree (equivalent to /e plus /purge). The /mir option is equivalent to the /e plus /purge options with one small difference in behavior: With the /e plus /purge options, if the destination directory exists, the destination directory security settings are not overwritten.</description></item><item><title>Windows - Changing a network interface profile to Private</title><link>https://blog.lukebtaylor.com/posts/windows-changing-a-network-interface-profile-to-private/</link><pubDate>Sun, 05 Jun 2016 22:11:44 -0600</pubDate><guid>https://blog.lukebtaylor.com/posts/windows-changing-a-network-interface-profile-to-private/</guid><description>Isn&amp;rsquo;t Windows Easy? Changing a network interface profile to Private
Windows interfaces kind of suck.
Let&amp;rsquo;s change one from whatever Windows decided to allocate it to and make it into a Private interface.
First, let&amp;rsquo;s take a look at all of the interfaces on the machine.
netsh interface ip show interfaces This is great, but the PowerShell commands we are going to use will only alllow us to change active connections.</description></item><item><title>dotnet - Enumerating a Registry Key Results in a Null Value</title><link>https://blog.lukebtaylor.com/posts/dotnet-enumerating-a-registry-key-results-in-a-null-value/</link><pubDate>Mon, 15 Feb 2016 22:11:16 -0600</pubDate><guid>https://blog.lukebtaylor.com/posts/dotnet-enumerating-a-registry-key-results-in-a-null-value/</guid><description>This post assumes .NET 4.0
After trying for some time to get a registry key to list all of its subkeys, I kept getting a null value back.
This code does not work It always returns null.
var keyName = @&amp;#34;SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileGuid&amp;#34;; using (var guidSet = Registry.LocalMachine.OpenSubKey(keyName)) { if (guidSet != null) { foreach (var guid in guidSet.GetSubKeyNames()) { result.Add(guid); Console.WriteLine(&amp;#34;{0}&amp;#34;, guid); } } } This code works
var keyName = @&amp;#34;SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileGuid&amp;#34;; using (var hklm = RegistryKey.</description></item><item><title>Windows - How Do I Disable Auto Brightness on a Laptop With AMD Graphics</title><link>https://blog.lukebtaylor.com/posts/windows-how-do-i-disable-auto-brightness-on-a-laptop-with-amd-graphics/</link><pubDate>Sat, 12 Apr 2014 22:17:19 -0600</pubDate><guid>https://blog.lukebtaylor.com/posts/windows-how-do-i-disable-auto-brightness-on-a-laptop-with-amd-graphics/</guid><description>I was having an issue with my HP Pavilion G7. When opening the web browser or switching between tabs, the display would automatically adjust its brightness. Here are three areas to look at to get it disabled. The screen will go dim and brighten at seemingly random times.
Option 1 - The AMD CCC is installed: If the AMD Catalyst Control Center installed, there is a setting to control the dimming and brightening of the screen called Vari-Bright.</description></item></channel></rss>